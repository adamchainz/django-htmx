(function(){let f;htmx.defineExtension("htmx-1-compat",{init:function(t){f=t;htmx.config.scrollBehavior="smooth";htmx.config.methodsThatUseUrlParams=["get"];htmx.config.selfRequestsOnly=false;if(!htmx.createEventSource){htmx.createEventSource=n}if(!htmx.createWebSocket){htmx.createWebSocket=e}},onEvent:function(t,e){switch(t){case"htmx:beforeCleanupElement":{const n=f.getInternalData(e.target);if(n.sseEventSource){n.sseEventSource.close()}if(n.webSocket){n.webSocket.close()}break}case"htmx:afterProcessNode":{r(o(e.target,"hx-sse"),function(t){const e=f.getInternalData(t);const n=f.getAttributeValue(t,"hx-sse");if(n){E(t,e,n)}});r(o(e.target,"hx-trigger"),function(t){d(t)});r(o(e.target,"hx-ws"),function(t){const e=f.getInternalData(t);const n=f.getAttributeValue(t,"hx-ws");if(n){s(t,e,n)}});r(o(e.target,"hx-on"),S);break}}}});function o(t,e){const n=[];if(f.hasAttribute(t,e)||f.hasAttribute(t,"hx-ws")){n.push(t)}t.querySelectorAll("["+e+"], [data-"+e+"], [data-hx-ws], [hx-ws]").forEach(function(t){n.push(t)});return n}function r(e,n){if(e){for(let t=0;t<e.length;t++){n(e[t])}}}function e(t){const e=new WebSocket(t,[]);e.binaryType=htmx.config.wsBinaryType;return e}function s(e,t,n){const o=u(n);for(let t=0;t<o.length;t++){const r=o[t].split(/:(.+)/);if(r[0]==="connect"){i(e,r[1],0)}if(r[0]==="send"){c(e)}}}function i(c,n,o){if(!f.bodyContains(c)){return}if(n.indexOf("/")===0){const t=location.hostname+(location.port?":"+location.port:"");if(location.protocol==="https:"){n="wss://"+t+n}else if(location.protocol==="http:"){n="ws://"+t+n}}const e=htmx.createWebSocket(n);e.onerror=function(t){f.triggerErrorEvent(c,"htmx:wsError",{error:t,socket:e});a(c)};e.onclose=function(t){if([1006,1012,1013].indexOf(t.code)>=0){const e=l(o);setTimeout(function(){i(c,n,o+1)},e)}};e.onopen=function(){o=0};f.getInternalData(c).webSocket=e;e.addEventListener("message",function(t){if(a(c)){return}let e=t.data;f.withExtensions(c,function(t){e=t.transformResponse(e,null,c)});const n=f.makeSettleInfo(c);const o=f.makeFragment(e);const r=h(o.children);for(let t=0;t<r.length;t++){const s=r[t];f.oobSwap(f.getAttributeValue(s,"hx-swap-oob")||"true",s,n)}f.settleImmediately(n.tasks)})}function a(t){if(!f.bodyContains(t)){f.getInternalData(t).webSocket.close();return true}}function c(l){const u=f.getClosestMatch(l,function(t){return f.getInternalData(t).webSocket!=null});if(u){l.addEventListener(f.getTriggerSpecs(l)[0].trigger,function(t){const e=f.getInternalData(u).webSocket;const n=f.getHeaders(l,u);const o=f.getInputValues(l,"post");const r=o.errors;const s=o.values;const c=f.getExpressionVars(l);const i=f.mergeObjects(s,c);let a=f.filterValues(i,l);a=Object.assign({},a);a.HEADERS=n;if(r&&r.length>0){f.triggerEvent(l,"htmx:validation:halted",r);return}e.send(JSON.stringify(a));if(f.shouldCancel(t,l)){t.preventDefault()}})}else{f.triggerErrorEvent(l,"htmx:noWebSocketSourceError")}}function l(t){const e=htmx.config.wsReconnectDelay;if(typeof e==="function"){return e(t)}if(e==="full-jitter"){const n=Math.min(t,6);const o=1e3*Math.pow(2,n);return o*Math.random()}g('htmx.config.wsReconnectDelay must either be a function or the string "full-jitter"')}function u(t){return t.trim().split(/\s+/)}function h(e){const n=[];if(e){for(let t=0;t<e.length;t++){n.push(e[t])}}return n}function g(t){if(console.error){console.error(t)}else if(console.log){console.log("ERROR: ",t)}}function n(t){return new EventSource(t,{withCredentials:true})}function E(e,t,n){const o=u(n);for(let t=0;t<o.length;t++){const r=o[t].split(/:(.+)/);if(r[0]==="connect"){m(e,r[1])}if(r[0]==="swap"){x(e,r[1])}}}function m(e,t){const n=htmx.createEventSource(t);n.onerror=function(t){f.triggerErrorEvent(e,"htmx:sseError",{error:t,source:n});v(e)};f.getInternalData(e).sseEventSource=n}function x(r,s){const c=f.getClosestMatch(r,w);if(c){const i=f.getInternalData(c).sseEventSource;const a=function(t){if(v(c)){return}if(!f.bodyContains(r)){i.removeEventListener(s,a);return}let e=t.data;f.withExtensions(r,function(t){e=t.transformResponse(e,null,r)});const n=f.getSwapSpecification(r,null);const o=f.getTarget(r);htmx.swap(o,e,n);f.triggerEvent(r,"htmx:sseMessage",t)};f.getInternalData(r).sseListener=a;i.addEventListener(s,a)}else{f.triggerErrorEvent(r,"htmx:noSSESourceError")}}function d(e){const n=f.getAttributeValue(e,"hx-trigger");if(!n){return}const o="sse:";let r=n.indexOf(o);while(r>=0){r+=o.length;let t=r+n.substring(r).search(/[,\[\s]/);if(t<r){t=n.length}const s=n.substring(r,t);p(e,function(){f.triggerEvent(e,o+s)},s);r=n.indexOf(o,r+o.length)}}function p(t,e,n){const o=f.getClosestMatch(t,w);if(o){const r=f.getInternalData(o).sseEventSource;const s=function(){if(!v(o)){if(f.bodyContains(t)){e(t)}else{r.removeEventListener(n,s)}}};f.getInternalData(t).sseListener=s;r.addEventListener(n,s)}else{f.triggerErrorEvent(t,"htmx:noSSESourceError")}}function v(t){if(!f.bodyContains(t)){f.getInternalData(t).sseEventSource.close();return true}}function w(t){return f.getInternalData(t).sseEventSource!=null}function S(n){const o=f.getAttributeValue(n,"hx-on");if(o){const r={};const s=o.split("\n");let t=null;let e=0;while(s.length>0){const c=s.shift();const i=c.match(/^\s*([a-zA-Z:\-.]+:)(.*)/);if(e===0&&i){c.split(":");t=i[1].slice(0,-1);r[t]=i[2]}else{r[t]+=c}e+=A(c)}for(const a in r){b(n,a,r[a])}}}function b(e,t,n){const o=f.getInternalData(e);if(!Array.isArray(o.onHandlers)){o.onHandlers=[]}let r;const s=function(t){return C(e,function(){if(!r){r=new Function("event",n)}r.call(e,t)})};e.addEventListener(t,s);o.onHandlers.push({event:t,listener:s})}function A(t){const e=k(t);let n=0;for(let t=0;t<e.length;t++){const o=e[t];if(o==="{"){n++}else if(o==="}"){n--}}return n}const D=/[_$a-zA-Z]/;const y=/[_$a-zA-Z0-9]/;const I=['"',"'","/"];function k(t){const e=[];let n=0;while(n<t.length){if(D.exec(t.charAt(n))){const o=n;while(y.exec(t.charAt(n+1))){n++}e.push(t.substr(o,n-o+1))}else if(I.indexOf(t.charAt(n))!==-1){const r=t.charAt(n);const o=n;n++;while(n<t.length&&t.charAt(n)!==r){if(t.charAt(n)==="\\"){n++}n++}e.push(t.substr(o,n-o+1))}else{const s=t.charAt(n);e.push(s)}n++}return e}function C(t,e,n){if(htmx.config.allowEval){return e()}else{f.triggerErrorEvent(t,"htmx:evalDisallowedError");return n}}})();
